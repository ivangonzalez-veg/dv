version: 2

models:

  - name: hub_survey
    description: This hub table contains metadata and business keys related to the concept of survey
  
    columns:
      - name: SURVEY_HK
        description: This is a unique identifier for the survey
        tests:
          - unique
          - not_null    
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: BINARY
          - dbt_utils.relationships_where:
              severity: warn
              to: ref('calpro_staging_calpronps')
              field: SURVEY_HK
              from_condition: RECORD_SOURCE = 'CALPRO'


      - name: SURVEY_ID
        description: This is ...
        tests:

      - name: COLLISION_KEY
        description: This is ... 

      - name: LOAD_DATE
        description: This is ... 
      
      - name: RECORD_SOURCE
        description: This is ...      

  - name: hub_location
    description: This hub table contains metadata and business keys related to the concept of location

    columns:
      - name: LOCATION_HK
        description: This is a unique identifier for the location
        tests:
          - unique
          - not_null    

      - name: LOCATION_NAME
        description: This is ...

      - name: LOAD_DATE
        description: This is ... 
      
      - name: RECORD_SOURCE
        description: This is ...      